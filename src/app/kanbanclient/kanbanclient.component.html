<div class="!w-[100%] flex flex-col p-4 lg:px-2 ">
  <button (click)="toogle()" class="p-2 bg-red-400 absolute top-0 right-0 ">
    Dark Mode
  </button>

  <div class="bread_crum  ">
    <ejs-breadcrumb cssClass="e-breadcrumb-chips">
      <e-breadcrumb-items>
        <e-breadcrumb-item text="Project" class=""></e-breadcrumb-item>
        <e-breadcrumb-item text="Sales 2025"></e-breadcrumb-item>

      </e-breadcrumb-items>
      <ng-template #separatorTemplate>
        <span class="material-symbols-outlined ">
          chevron_right
        </span>
      </ng-template>
    </ejs-breadcrumb>
  </div>

  <div class="search flex flex-col md:flex-row md:justify-between md:items-center gap-y-3 md:gap-y-0 mb-4 mt-3">
    <div class=" first_child  flex items-center gap-x-1  lg:ml-2">
      <img src="images/image.svg" class="w-5 h-5" alt="CompanyLogo" />
      <span class="text-base dark:text-white text-[#111827] font-semibold">Sales Pipelines</span>
    </div>
    <div class="second_child flex  items-center gap-x-1  ">
      <div class="inputgroup flex items-center px-1 lg:border border-[#D1D5DB] dark:border-[#6B7280] rounded-sm">
        <input type="text" placeholder="Search..." class="hidden lg:flex bg-transparent ">
        <span class="material-symbols-outlined text-[#6B7280] dark:text-[#6B7280] text-base md:text-xl">search</span>
      </div>

      <div class="text-[#4B5563] mr-3  md:mr-2">|</div>
      <div class="flex ">
        <span class="-ml-2"> <img src="https://randomuser.me/api/portraits/women/63.jpg" alt="footer_avatar"
            class="w-6 h-6 rounded-full "></span>
        <span class="-ml-2"><img src="https://randomuser.me/api/portraits/women/63.jpg" alt="footer_avatar"
            class="w-6 h-6 rounded-full "></span>
        <span class="-ml-2"><img src="https://randomuser.me/api/portraits/women/63.jpg" alt="footer_avatar"
            class="w-6 h-6 rounded-full "></span>
        <span
          class="-ml-2 !text-xs flex items-center justify-center  bg-[#F3F4F6] dark:bg-[#374151] dark:text-[#F3F4F6] w-6 h-6 rounded-full  ">+5</span>

      </div>
    </div>



  </div>

  <div>
    <ejs-kanban class="!bg:white dark:!bg-[#1F2937] !text-black dark:!text-red-400" width="100%" height="100%"
      [dataSource]="data" keyField="Status" [cardSettings]="cardSettings" [allowDragAndDrop]="false"
      (dataBound)="onKanbanDataBound()">
      <e-columns>
        <e-column headerText="All leads" keyField="All leads" [template]="leadHeader"></e-column>
        <e-column headerText="Qualified lead" keyField="Qualified lead" [template]="leadHeader"></e-column>
        <e-column headerText="Proposal sent" keyField="Proposal sent" [template]="leadHeader"></e-column>
        <e-column headerText="Client feedback" keyField="Client feedback" [template]="leadHeader"></e-column>
        <e-column headerText="Declined" keyField="Declined" [template]="leadHeader"></e-column>
        <e-column headerText="Won" keyField="Won" class="!bg-red-400" [template]="leadHeader"></e-column>
      </e-columns>
      <ng-template #cardSettingsTemplate let-item>
        <section class="main_container  dark:!bg-[#1F2937] dark:!text-white !bg-white !text-[#111827] ">
          <div class="card_container  ">
            <div class="card_one !pt-2  !px-3 !flex !flex-col !gap-y-2">
              <div class="header_container !flex !items-center !justify-between">
                <div class="one !flex ">
                  <div class="schedule !flex !gap-x-1 !items-center"
                    *ngIf="['Qualified lead', 'Proposal sent'].includes(item.Status)">
                    <span class="material-symbols-outlined !text-xs !text-[#6B7280] dark:!text-[#D1D5DB]"
                      *ngIf="['Qualified lead'].includes(item.Status) ">
                      diversity_4
                    </span>
                    <span class="material-symbols-outlined !text-xs !text-[#6B7280] dark:!text-[#D1D5DB]"
                      *ngIf="['Proposal sent'].includes(item.Status)">
                      event_available
                    </span>
                    <span
                      class="!text-xs md:!text-[10px] !text-[#374151] dark:!text-[#F3F4F6] ">{{item.ScheduleTime}}</span>
                  </div>
                  <span class="decline_accept !text-xs  !px-2 !py-0.5 !rounded-xl "
                    [class]="item.ClientResult=== 'Declined' ? 'dark:!bg-[#7F1D1D] dark:!text-[#F87171] !bg-[#FEF2F2] !text-[#DC2626]' : 'text-[#15803D] bg-[#F0FDF4] dark:text-[#22C55E] dark:bg-[#14532D]'"
                    *ngIf="['Declined', 'Won'].includes(item.Status)">
                    {{item.ClientResult}}
                  </span>
                </div>
                <div class="two">
                  <div
                    class="dollar !flex !items-center !px-1 !py-0.5 !rounded-xl !text-[#0E7490] !bg-[#ECFEFF] dark:!bg-[#164E63] dark:!text-[#38BDF8]"
                    *ngIf="['Qualified lead', 'Proposal sent'].includes(item.Status)">
                    <span class="material-symbols-outlined !text-xs">
                      attach_money
                    </span>
                    <span class="!text-xs">{{item.CompanyProposeMoney}}</span>
                  </div>
                </div>
              </div>
              <div class="body_container !flex !flex-col !gap-y-2">
                <div class="change_no !flex !items-center !gap-1">
                  <div class="avatar !w-7 !h-7 ">
                    <img *ngIf="item.Avatar" [src]="item.Avatar" alt="avatar"
                      class="!w-full !h-full !rounded-full !border !object-fill" />
                  </div>
                  <div class="person_details !flex !flex-col !justify-center ">
                    <span class="name !text-sm !font-medium " *ngIf="item.Name">{{ item.Name }}</span>
                    <span class="email !text-[10px] !font-light !leading-none !text-[#374151] dark:!text-[#F3F4F6] "
                      *ngIf="item.Email">{{
                      item.Email }}</span>
                  </div>
                </div>
                <div class="body_main_change   !flex !flex-col !gap-2">
                  <div class="the_closeup !flex !gap-1 !flex-col"
                    [class]="item.Status=='Client feedback'? 'flex-col-reverse' :'' ">
                    <div class="two_box !gap-y-2 dark:!bg-[#374151] !bg-[#F3F4F6]  !p-2 !flex !flex-col  !rounded-lg "
                      *ngIf="['Proposal sent','Client feedback'].includes(item.Status)">
                      <p *ngIf="['Proposal sent','Client feedback'].includes(item.Status)" class="!text-xs  "> Closing
                        :
                        <span class="!text-xs !font-medium">{{ item.Closing }}</span>
                      </p>
                      <p *ngIf="['Proposal sent'].includes(item.Status)" class="!text-xs  "> Follow-up : <span
                          class="!text-xs !font-medium ">{{ item.FollowUp }}</span></p>
                    </div>
                    <div
                      class="feedback dark:!bg-[#374151] !bg-[#F3F4F6] !flex  !items-center !p-2 !gap-x-1 !rounded-lg"
                      *ngIf="['Proposal sent', 'Client feedback','Declined'].includes(item.Status)">
                      <span class="material-symbols-outlined !text-xs">
                        chat_bubble
                      </span>
                      <span class="feedback_msg !text-xs !font-medium ">{{item.Feedback}}</span>
                    </div>
                  </div>
                  <div *ngIf="item.Status === 'Qualified lead'" class="progress_bar ">
                    <div class="dark:!bg-[#374151] !bg-[#F3F4F6] !p-2 !flex !flex-col !gap-y-2 !rounded-lg">
                      <div class="progress_data !text-[#374151] !flex !justify-between  dark:!text-[#F3F4F6]">
                        <span class="!text-xs "> Qualification score</span>
                        <span class="!text-xs !font-medium">50%</span>
                      </div>
                      <div class="progress_bar !w-full !bg-[#E5E7EB] dark:!bg-[#4B5563] !rounded-full">
                        <span class="!bg-[#22C55E] !w-[60%] !block !h-1 !rounded-full"></span>
                      </div>
                    </div>
                  </div>
                  <div *ngIf="item.Status === 'Won'"
                    class="!text-xs !font-medium !px-2 !w-max !py-0.5 !rounded-xl dark:!bg-[#232E3E] dark:!text-white !text-[#111827] !bg-[#F9FAFB]">
                    ${{item.CompanyProposeMoney}}
                  </div>
                  <div class="priority_sorce !gap-x-2 !flex !items-center !align-middle"
                    *ngIf="['All leads', 'Qualified lead', 'Proposal sent', 'Client feedback'].includes(item.Status)">
                    <div class="priority  !text-xs !px-2 !py-0.5 !rounded-xl !flex !items-center !gap-1" [ngClass]="{
                    'dark:!bg-[#7F1D1D] dark:!text-[#F87171] !bg-[#FEF2F2] !text-[#DC2626]': item.Priority === 'High',
                    'dark:!bg-[#7C2D12] dark:!text-[#F97316] !bg-[#FFF7ED] !text-[#C2410C]' : item.Priority === 'Medium',
                    'dark:!bg-[#164E63] dark:!text-[#38BDF8] !bg-[#ECFEFF] text-[#0E7490]': item.Priority === 'Low'
                  }">
                      <span class="material-symbols-outlined !text-xs" *ngIf="item.Priority === 'High'">
                        present_to_all
                      </span>
                      <span class="material-symbols-outlined !text-xs" *ngIf="item.Priority === 'Low'">
                        system_update_alt
                      </span>
                      <span class="material-symbols-outlined !text-xs" *ngIf="item.Priority === 'Medium'">
                        exit_to_app
                      </span>
                      <span class="priority_text !text-xs ">{{item.Priority}}</span>
                    </div>
                    <div
                      class="source  !text-sm !px-2 !py-0.5 !rounded-md !flex !items-center !gap-x-1 !bg-[#F9FAFB] dark:!bg-[#232E3E]">
                      <span class="source_text !text-xs "> {{item.Source}}</span>
                      <img [src]="'images/'+item.Source+'.svg'" alt="" class="!w-3 !h-3">
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class=" card-two line through !w-full !h-0.5 dark:!bg-[#4B5563] !bg-[#E5E7EB] !mb-1 !mt-4"></div>
            <div class=" card-three footer_container !p-2 !px-3 !flex !justify-between">
              <div class="logo_tag !flex !items-center !gap-x-2">
                <div class="company_working !flex !items-center !gap-x-1">
                  <span
                    class="material-symbols-outlined !text-xs !font-extralight dark:!text-[#D1D5DB] !text-[#6B7280]">
                    apartment
                  </span>
                  <span
                    class="building_text !text-xs !font-medium !text-[#374151] dark:!text-[#F3F4F6] ">{{item.ClientCompany}}</span>
                </div>
                <div
                  class="client_position !text-xs !px-2 !py-0.5 dark:!border !border-2 !text-[#374151] dark:!text-[#F3F4F6] dark:!border-[#4B5563] !border-[#E5E7EB]  !rounded-xl !bg-[#F9FAFB] dark:!bg-[#232E3E]">
                  {{item.ClientNiche}}
                </div>
              </div>
              <div class="avatar">
                <img src={{item.Avatar}} alt="footer_avatar" class="!w-6 !h-6 !rounded-full !border">
              </div>
            </div>
          </div>
        </section>
      </ng-template>
      <e-stackedHeaders>



        <e-stackedHeader text="New leads" keyFields="All leads,Qualified lead"></e-stackedHeader>

        <e-stackedHeader text="Negotiation" keyFields="Proposal sent,Client feedback,Declined"></e-stackedHeader>
        <e-stackedHeader text="Closed" keyFields="Won"></e-stackedHeader>
      </e-stackedHeaders>

      <ng-template #leadHeader let-data>
        <div class="!flex !items-center  !w-[100%] !gap-x-2 !relative">

          <span class="material-symbols-outlined !text-base " [ngClass]="{
            '!text-[#DC2626] dark:!text-[#DC2626]': data.keyField === 'Declined',
            '!text-[#15803D] dark:!text-[#15803D]': data.keyField === 'Won' || data.keyField === 'Qualified lead',
            'dark:!text-[#D1D5DB] !text-[#6B7280]': data.keyField === 'All leads' || data.keyField === 'Proposal sent' || data.keyField==='Client feedback'
          }">
            {{ getIcon(data.keyField) }}
          </span>
          <span class="!font-bold !text-sm dark:!text-[#FFFFFF] !text-[#111827]">{{ data.headerText }}</span>
          <span
            class="  e-item-count !text-sm dark:!bg-[#4B5563] !bg-[#E5E7EB] !text-[#374151] !w-5 !h-5 !flex !justify-center !items-center !rounded-sm dark:!text-[#F3F4F6]">
            {{ getCount(data.keyField) }} </span>
          <span
            class="material-symbols-outlined !text-base dark:!text-[#D1D5DB] !text-[#6B7280] !absolute !right-0">add</span>
        </div>
      </ng-template>
    </ejs-kanban>
  </div>

</div>